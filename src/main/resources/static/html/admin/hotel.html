<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>酒店管理-添加酒店</title><link rel="stylesheet" href="/html/admin/css/style.default.css" type="text/css" /><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery-1.7.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery-ui-1.8.16.custom.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery.cookie.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery.uniform.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery.validate.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/jquery.tagsinput.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/charCount.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/ui.spinner.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/plugins/chosen.jquery.min.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/custom/general.js"></script>--><!--<script type="text/javascript" src="/html/admin/js/custom/forms.js"></script>-->    <script src="/html/hotel/js/jquery-2.1.4.min.js"></script><!--[if IE 9]>    <link rel="stylesheet" media="screen" href="/html/admin/css/style.ie9.css"/><![endif]--><!--[if IE 8]>    <link rel="stylesheet" media="screen" href="/html/admin/css/style.ie8.css"/><![endif]--><!--[if lt IE 9]>	<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script><![endif]--></head><body class="withvernav"><div class="bodywrapper">    <div class="topheader">        <div class="left">            <h1 class="logo">酒店.<span>后台管理系统</span></h1>            <span class="slogan">后台管理系统</span>            <div class="search">                <form action="" method="post">                    <input type="text" name="keyword" id="keyword" value="请输入" />                    <button class="submitbutton"></button>                </form>            </div><!--search-->            <br clear="all" />        </div><!--left-->        <div class="right">            <!--<div class="notification">                <a class="count" href="ajax/notifications.html"><span>9</span></a>            </div>-->            <div class="userinfo">                <img src="/html/admin/images/thumbs/avatar.png" alt="" />                <span>管理员</span>            </div><!--userinfo-->            <div class="userinfodrop">                <div class="avatar">                    <a href=""><img src="/html/admin/images/thumbs/avatarbig.png" alt="" /></a>                    <div class="changetheme">                        切换主题: <br />                        <a class="default"></a>                        <a class="blueline"></a>                        <a class="greenline"></a>                        <a class="contrast"></a>                        <a class="custombg"></a>                    </div>                </div><!--avatar-->                <div class="userdata">                    <h4>Juan</h4>                    <span class="email">youremail@yourdomain.com</span>                    <ul>                        <li><a href="editprofile.html">编辑资料</a></li>                        <li><a href="accountsettings.html">账号设置</a></li>                        <li><a href="help.html">帮助</a></li>                        <li><a href="index.html">退出</a></li>                    </ul>                </div><!--userdata-->            </div><!--userinfodrop-->        </div><!--right-->    </div><!--topheader-->    <div class="header">        <ul class="headermenu">            <li><a href="/admin/dashboard"><span class="icon icon-flatscreen"></span>首页</a></li>            <li class="current"><a href="/admin/hotel"><span class="icon icon-pencil"></span>酒店管理</a></li>            <li><a href="/admin/user"><span class="icon icon-message"></span>会员管理</a></li>            <li><a href="/admin/order"><span class="icon icon-message"></span>订单管理</a></li>            <li><a href="/admin/report"><span class="icon icon-chart"></span>统计报表</a></li>        </ul>        <div class="headerwidget">            <div class="earnings">                <div class="one_half">                    <h4>入住人数</h4>                    <h2 id="usernum"></h2>                </div><!--one_half-->                <div class="one_half last alignright">                    <h4>入住率</h4>                    <h2 id="userrat"></h2>                </div><!--one_half last-->            </div><!--earnings-->        </div><!--headerwidget-->    </div><!--header-->    <div class="vernav2 iconmenu">        <ul>            <li><a href="/admin/hotel" class="gallery">酒店管理</a></li>            <li><a href="/admin/user" class="elements">会员管理</a></li>            <li><a href="/admin/order" class="calendar">订单管理</a></li>            <li><a href="/admin/report" class="widgets">统计信息</a></li>        </ul>        <a class="togglemenu"></a>        <br /><br />    </div><!--leftmenu-->    <div class="centercontent">        <div class="pageheader">            <h1 class="pagetitle">酒店管理</h1>            <span class="pagedesc">添加酒店</span>                        <ul class="hornav">                <li><a href="/admin/hotel">酒店管理</a></li>                <li class="current"><a>添加酒店</a></li>            </ul>        </div><!--pageheader-->                <div id="contentwrapper" class="contentwrapper">            <form id="form1" class="stdform" method="post"  action="/hotel/addhotel" enctype="multipart/form-data">            <div id="validation" class="subcontent">                    	<p>                        	<label>酒店名称</label>                            <span class="field"><input type="text" name="hotelname" id="hotelname" class="longinput" /></span>                        </p>                                                <p>                        	<label>酒店地址</label>                            <span class="field"><input type="text" name="address" id="address" class="longinput" /></span>                        </p>                                                <p>                        	<label>酒店说明</label>                            <span class="field"><input type="text" name="note" id="note" class="longinput" /></span>                        </p>                <p>                    <label>是否热门</label>                    <span class="formwrapper">                            	<input type="checkbox" name="ishot" id="ishot" checked="checked" />热门<br />                            </span>                </p>                        <p>                            <label>酒店图片</label>                            <span class="field">                            	<input type="file" name="pic" id="pic" />                                <img id="img" />                            </span>                        </p>                                                <br />                        <input id="id" name="id" value="0" type="hidden" />                        <p class="stdformbutton">                        	<button class="submit radius2">提交</button>                        </p>            </div><!--subcontent-->            </form>        </div><!--contentwrapper-->        	</div><!-- centercontent -->    <script type="text/javascript">        $(function () {            var base64="";            $("#pic").change(function(){                var file = this.files[0];                if(!/image\/\w+/.test(file.type)){                    alert("文件必须为图片！");                    return false;                }                $("#img").attr("src",URL.createObjectURL($(this)[0].files[0]));                var reader = new FileReader();                reader.readAsDataURL(file);                reader.onload = function (e) { base64= this.result; }            });            $(".submit").click(function () {                if($("#name").val()==""){                    alert("酒店名称不能为空")                    return false;                }                if($("#address").val()==""){                    alert("酒店地址不能为空")                    return false;                }                if($("#note").val()==""){                    alert("酒店说明不能为空")                    return false;                }                var ischeck=$("input[name='check2']:checked").val()=="on"?1:0;                //$("#form1").submit();                var formData = new FormData($( "#form1" )[0]);                $.ajax({url:"/hotel/addhotel",type: "POST",data:formData,success:function (data) {                    if(data&&data.code==1){                        alert("恭喜您添加成功")                        location.href=location.href;                    }else{                        alert("添加失败："+data.msg)                    }                }})            })        })        $.ajax({url:"/hotel/getCount",success:function(result){            var num1=0,num2=0;                if(result&&result.data&&result.data.length>0) {                    result.data.forEach(function (item,index) {                        switch (index){                            case 0:                                num2=item;                                break;                            case 1:                                num1=item;                                break;                            case 3:                                $("#usernum").text(item)                                break;                        }                    })                    console.log(num1+"   "+num2)                    var rat=parseFloat(num2/num1).toFixed(2)*100;                    $("#userrat").text(rat+"%")                }            }});        //获取url中的参数        function getQueryString(name) {            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); // 匹配目标参数            var result = window.location.search.substr(1).match(reg); // 对querystring匹配目标参数            if (result != null) {                return decodeURIComponent(result[2]);            } else {                return null;            }        }        var id=getQueryString("id")        if(parseInt(id)>0) {            $.ajax({                url: "/hotel/getHotelById", data: {hotelid: id}, success: function (result) {                    var num1 = 0, num2 = 0;                    if (result && result.data && result.data.hotel) {                        $("#hotelname").val(result.data.hotel.hotelname)                        $("#address").val(result.data.hotel.address)                        $("#note").val(result.data.hotel.note);                        $("#id").val(id);                        console.log(result.data.hotel.pic)                        // $("#pic").val(result.data.experiment.pic);                        $("#img").attr("src",result.data.hotel.pic);                        if(result.data.hotel.ishot==1){                            $("#ishot").attr("checked",true);                        }else{                            $("#ishot").attr("checked",true);                        }                    }                }            });        }    </script>    </div><!--bodywrapper--></body></html>