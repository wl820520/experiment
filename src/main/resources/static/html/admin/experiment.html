<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>实验台管理--实验管理</title>
<link rel="stylesheet" href="/html/admin/css/style.default.css" type="text/css" />
    <script src="/js/jquery-1.10.2.js"></script>
<!--[if IE 9]>
    <link rel="stylesheet" media="screen" href="/html/admin/css/style.ie9.css"/>
<![endif]-->
<!--[if IE 8]>
    <link rel="stylesheet" media="screen" href="/html/admin/css/style.ie8.css"/>
<![endif]-->
<!--[if lt IE 9]>
	<!--<script src="js/plugins/css3-mediaqueries.js"></script>-->
<![endif]-->
</head>

<body class="withvernav">
<div class="bodywrapper">
    <div th:include="html/admin/inner :: copyheader ('experiment')"></div>

    <div class="centercontent">

        <div class="pageheader">
            <h1 class="pagetitle">实验管理</h1>
            <span class="pagedesc">The content below are loaded using ajax</span>
            <ul class="hornav">
                <li class="current"><a>实验管理</a></li>
                <li><a id="add" href="/admin/addexperiment">添加实验</a></li>
            </ul>
        </div><!--pageheader-->

        <div id="contentwrapper" class="contentwrapper">

            <div id="inbox" class="subcontent">

                <div class="msghead">
                    <ul class="msghead_menu">
                        <li class="marginleft5"><a class="msgtrash" title="Trash"></a></li>
                        <li class="right"><a class="next"></a></li>
                        <li class="right"><a class="prev prev_disabled"></a></li>
                        <li class="right"><span class="pageinfo">1-10 of 2,139</span></li>
                    </ul>
                    <span class="clearall"></span>
                </div><!--msghead-->

                <table cellpadding="0" cellspacing="0" border="0" class="stdtable mailinbox">
                    <colgroup>
                        <col class="con1" width="4%"/>
                        <col class="con0" width="4%" />
                        <col class="con1" width="15%"/>
                        <col class="con0" width="15%"/>
                        <col class="con1" width="15%"/>
                        <col class="con0" width="15%"/>
                        <col class="con1" width="44%"/>
                        <col class="con1" width="10%"/>
                    </colgroup>
                    <thead>
                    <tr>
                        <th width="20" class="head1 aligncenter"><input type="checkbox" name="checkall" class="checkall" /></th>
                        <th class="head0 attachement">id</th>
                        <th class="head1">实验类型</th>
                        <th class="head0">实验名称</th>
                        <th class="head1">试题内容</th>
                        <th class="head0">操作</th>
                    </tr>
                    </thead>
                    <tfoot>
                    <tr>
                        <th class="head1 aligncenter"><input type="checkbox" name="checkall" class="checkall2" /></th>
                        <th class="head0 attachement">id</th>
                        <th class="head1">实验类型</th>
                        <th class="head0">实验名称</th>
                        <th class="head1">试题内容</th>
                        <th class="head0">操作</th>
                    </tr>
                    </tfoot>
                    <tbody id="userlist">
                    </tbody>
                </table>
            </div>
        </div><!--contentwrapper-->

    </div><!--centercontent-->

    
</div><!--bodywrapper-->

<script type="text/javascript">
    $(function () {
        //获取url中的参数
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); // 匹配目标参数
            var result = window.location.search.substr(1).match(reg); // 对querystring匹配目标参数
            if (result != null) {
                return decodeURIComponent(result[2]);
            } else {
                return null;
            }
        }
        // var id=getQueryString("id")
        // $("#add").attr("href","/admin/addexperiment?id="+id)
        // if(id&&id>0) {
            $.ajax({
                url: "/admin/getExperimentList", success: function (result) {
                    if (result && result.code == 1 && result.data) {
                        $("#userlist").empty();
                        result.data.forEach(function (item, index) {
                            var unread = (index % 2 == 0 ? "unread" : "");
                            bindexperiment(item, unread);
                        })
                        bindclick()
                    }
                }
            });
        // }else{
        //     alert("参数错误")
        // }
        function bindexperiment(data,unread) {
            var userhtml="<tr class=\""+unread+"\">\n" +
                "                            <td class=\"aligncenter\"><input type=\"checkbox\" name=\"\" /></td>\n" +
                "                            <td class=\"aligncenter\">{id}</td>\n" +
                "                            <td>{experimentname}</td>\n" +
                "                            <td>{experimenttitle}</td>\n" +
                "                            <td><a val='{id}' t='checkquestion' class=\"btn btn4 btn_link\"></a></td>\n" +
                "                            <td class=\"date\"><a val='{id}' t='update' class=\"btn btn4 btn_link\"></a><a val='{id}' t='del' class=\"btn btn4 btn_trash\"></a></td>\n" +
                "                        </tr>";
            userhtml=userhtml.replace("{id}",data.id)
            userhtml=userhtml.replace("{id}",data.id)
            userhtml=userhtml.replace("{id}",data.id)
            userhtml=userhtml.replace("{id}",data.id)
            userhtml=userhtml.replace("{experimentname}",data.title)
            userhtml=userhtml.replace("{experimenttitle}",data.content)
            userhtml=userhtml.replace("{jsonstrsub}",data.json_value)
            $("#userlist").append(userhtml)

        }
    })
    function bindclick() {
        $("a[t='del']").click(function () {
            if(confirm("确定删除？")) {
                var id = $(this).attr("val")
                $.ajax({
                    url: "/admin/delexperiment", data: {id: id}, success: function (result) {
                        if (result && result.code == 1) {
                            alert("删除成功");
                            location.href = location.href;
                        } else {
                            alert("删除失败")
                        }
                    }
                });
            }
        })
        $("a[t='update']").click(function () {
                var id = $(this).attr("val")
                location.href="/admin/addexperiment?id="+id;
        })
        $("a[t='checkquestion']").click(function () {
            var id = $(this).attr("val")
            location.href="/admin/questionbasetype?id="+id;
        })
    }
    // $.ajax({url:"/hotel/getCount",success:function(result){
    //         var num1=0,num2=0;
    //         if(result&&result.data&&result.data.length>0) {
    //             result.data.forEach(function (item,index) {
    //                 switch (index){
    //                     case 0:
    //                         num2=item;
    //                         break;
    //                     case 1:
    //                         num1=item;
    //                         break;
    //                     case 3:
    //                         $("#usernum").text(item)
    //                         break;
    //                 }
    //             })
    //             console.log(num1+"   "+num2)
    //             var rat=parseFloat(num2/num1).toFixed(2)*100;
    //             $("#userrat").text(rat+"%")
    //         }
    //     }});
</script>
</body>
</html>
